apiVersion: "v1"
protocol: "telnet"
address: ":23"
description: "TELNET interactive"
commands:
  - regex: "^ls$"
    handler: "bin  boot  dev  etc  home  lib  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var"
  - regex: "^ls -la$"
    handler: "total 84\ndrwxr-xr-x 21 root root 4096 Jan 15 10:30 .\ndrwxr-xr-x 21 root root 4096 Jan 15 10:30 ..\ndrwxr-xr-x  2 root root 4096 Jan 10 08:15 bin\ndrwxr-xr-x  3 root root 4096 Jan 10 08:15 boot"
  - regex: "^pwd$"
    handler: "/root"
  - regex: "^whoami$"
    handler: "root"
  - regex: "^id$"
    handler: "uid=0(root) gid=0(root) groups=0(root)"
  - regex: "^uname$"
    handler: "Linux"
  - regex: "^uname -a$"
    handler: "Linux telnet-server 5.4.0-42-generic #46-Ubuntu SMP Fri Jul 10 00:24:02 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux"
  - regex: "^uname -m$"
    handler: "x86_64"
  - regex: "^cat /etc/passwd$"
    handler: "root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nuser:x:1000:1000:user:/home/user:/bin/bash"
  - regex: "^ps$"
    handler: "  PID TTY          TIME CMD\n 1234 pts/0    00:00:00 bash\n 5678 pts/0    00:00:00 ps"
  - regex: "^ps aux$"
    handler: "USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot         1  0.0  0.1  16904  2048 ?        Ss   10:30   0:00 /sbin/init\nroot       123  0.0  0.2  21012  4096 ?        S    10:30   0:00 /usr/sbin/sshd"
  - regex: "^ifconfig$"
    handler: "eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 192.168.1.100  netmask 255.255.255.0  broadcast 192.168.1.255"
  - regex: "^netstat$"
    handler: "Active Internet connections (w/o servers)\nProto Recv-Q Send-Q Local Address           Foreign Address         State\ntcp        0      0 192.168.1.100:23        192.168.1.50:52341      ESTABLISHED"
  - regex: "^w$"
    handler: " 14:23:01 up 3 days,  4:15,  1 user,  load average: 0.08, 0.05, 0.01\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nroot     pts/0    192.168.1.50     14:20    0.00s  0.01s  0.00s w"
  - regex: "^echo (.+)$"
    handler: "$1"
  - regex: "^(.+)$"
    handler: "bash: $1: command not found"
serverVersion: "Linux telnetd"
serverName: "telnet-server"
passwordRegex: "^(root|admin|password|123456|telnet|guest|cisco|oracle)$"
deadlineTimeoutSeconds: 60
