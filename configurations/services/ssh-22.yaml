apiVersion: "v1"
protocol: "ssh"
address: ":22"
description: "SSH interactive"
commands:
  # High-value tripwire commands - trigger alerts when attackers attempt these
  - regex: "^cat /etc/shadow$"
    handler: "cat: /etc/shadow: Permission denied"
    alert: true
    severity: "critical"
  - regex: "^cat /etc/passwd$"
    handler: "root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin"
    alert: true
    severity: "high"
  - regex: "^(wget|curl) .*$"
    handler: "command not found"
    alert: true
    severity: "high"
  # Normal commands - no alerts
  - regex: "^ls$"
    handler: "Documents Images  Desktop Downloads .m2 .kube .ssh  .docker"
  - regex: "^pwd$"
    handler: "/home/"
  - regex: "^uname -m$"
    handler: "x86_64"
  - regex: "^docker ps$"
    handler: "CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES"
  - regex: "^docker .*$"
    handler: "Error response from daemon: dial unix docker.raw.sock: connect: connection refused"
  - regex: "^uname$"
    handler: "Linux"
  - regex: "^ps$"
    handler: "  PID TTY           TIME CMD\n21642 ttys000    0:00.07 /bin/dockerd"
  - regex: "^(.+)$"
    handler: "command not found"
serverVersion: "OpenSSH"
serverName: "ubuntu"
passwordRegex: "^(root|qwerty|Smoker666|123456|jenkins|minecraft|sinus|alex|postgres|Ly123456)$"
deadlineTimeoutSeconds: 60